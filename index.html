<!DOCTYPE html>
<html lang="cs">
<head>
    <!-- iOS specifick칠 meta tagy -->
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="default">
<meta name="apple-mobile-web-app-title" content="AugView">
<link rel="apple-touch-icon" sizes="180x180" href="/img/apple-touch-icon.png">
<link rel="apple-touch-startup-image" href="/img/apple-splash-2048-2732.png">
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="icon" type="image/png" href="img/favicon.png" />
    <title>AR Aplikace</title>

    <!-- === SKRIPT PRO KONTROLU PRVN칈 N츼VT캨VY (MUS칈 B칗T HNED NA ZA캛츼TKU HEAD) === -->
    <script>
      // Nahra캞te skript v <head> index.html t칤mto k칩dem:
(function() {
  const visitedInfoFlagKey = 'arAppVisitedInfo_v1';
  const consentStatusKey = 'ga_consent_status';

  // Funkce pro bezpe캜n칠 캜ten칤 localStorage s fallbackem
  function safeGetLocalStorage(key) {
    try {
      return localStorage.getItem(key);
    } catch (e) {
      console.warn(`localStorage 캜ten칤 selhalo pro kl칤캜 ${key}:`, e);
      return null;
    }
  }

  // Funkce pro bezpe캜n칠 nastaven칤 localStorage
  function safeSetLocalStorage(key, value) {
    try {
      localStorage.setItem(key, value);
      return true;
    } catch (e) {
      console.warn(`localStorage z치pis selhal pro kl칤캜 ${key}:`, e);
      return false;
    }
  }

  // Detekce iOS standalone re쬴mu
  const isIOSStandalone = navigator.userAgent.match(/iPhone|iPad|iPod/) && 
                         window.navigator.standalone;

  try {
    const hasVisited = safeGetLocalStorage(visitedInfoFlagKey);
    const consentStatus = safeGetLocalStorage(consentStatusKey);

    // Pro iOS standalone: pou쬴j sessionStorage jako fallback
    if (isIOSStandalone && (!hasVisited || !consentStatus)) {
      const sessionVisited = sessionStorage.getItem(visitedInfoFlagKey);
      const sessionConsent = sessionStorage.getItem(consentStatusKey);
      
      if (!sessionVisited || !sessionConsent) {
        console.log('iOS standalone: Prvn칤 n치v코t캩va detekov치na. P콏esm캩rov치v치m na info.html');
        sessionStorage.setItem(visitedInfoFlagKey, 'true');
        window.location.replace('info.html');
        return;
      }
    }

    // Standardn칤 logika pro ostatn칤 p콏칤pady
    if (hasVisited !== 'true' || !consentStatus) {
      console.log('Prvn칤 n치v코t캩va nebo chyb캩j칤c칤 souhlas detekov치n. P콏esm캩rov치v치m na info.html');
      
      if (hasVisited !== 'true') {
        safeSetLocalStorage(visitedInfoFlagKey, 'true');
      }
      
      window.location.replace('info.html');
    } else {
      console.log('Opakovan치 n치v코t캩va a souhlas nalezen. Na캜칤t치m index.html norm치ln캩.');
    }
  } catch (e) {
    console.error('Chyba p콏i kontrole prvn칤 n치v코t캩vy:', e);
    // V p콏칤pad캩 chyby jdi na info str치nku pro jistotu
    window.location.replace('info.html');
  }
})();
    </script>
    <!-- === KONEC SKRIPTU PRVN칈 N츼VT캨VY === -->


    <!-- Google Analytics Consent Mode - V칳choz칤 nastaven칤 (P콎ED gtag.js) -->
    <script>
        // Define dataLayer and the gtag function.
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}

        // Nastav칤 v칳choz칤 stav souhlasu na ZAM칈TNUTO p콏ed na캜ten칤m gtag.js
        console.log('Setting default consent state to denied (index.html).');
        gtag('consent', 'default', {
            'ad_storage': 'denied',
            'ad_user_data': 'denied',
            'ad_personalization': 'denied',
            'analytics_storage': 'denied' // Kl칤캜ov칠 pro Google Analytics
        });

        // Pokus칤 se na캜칤st ulo쬰n칳 souhlas z localStorage
        // Tento k칩d se spust칤, jen pokud skript v칳코e NEp콏esm캩roval na info.html
        const savedConsent = localStorage.getItem('ga_consent_status');
        if (savedConsent) {
            try {
                const consentState = JSON.parse(savedConsent);
                console.log('Found saved consent state on index.html:', consentState);
                gtag('consent', 'update', consentState); // Aktualizuje stav podle ulo쬰n칠 volby
            } catch (e) {
                console.error('Error parsing saved consent on index.html:', e);
                localStorage.removeItem('ga_consent_status'); // Odstran칤 neplatn치 data
            }
        } else {
             // Toto by nem캩lo nastat, pokud kontrola prvn칤 n치v코t캩vy funguje spr치vn캩,
             // ale pro jistotu logujeme.
             console.log('No saved consent found on index.html, default denied remains.');
        }
    </script>

    <!-- Google tag (gtag.js) - Na캜ten칤 knihovny -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-NRST1685GR"></script>
    <script>
        // Inicializace gtag funkce a vol치n칤 'config'
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());

        // TATO 콎츼DKA JE ZDE NUTN츼 - inicializuje m캩콏en칤 pro GA4
        // Bude respektovat stav souhlasu nastaven칳 v칳코e.
        gtag('config', 'G-NRST1685GR');
        console.log('gtag.js loaded and config command executed on index.html for G-NRST1685GR');
    </script>

    <!-- Va코e st치vaj칤c칤 CSS a dal코칤 head tagy -->
    <link rel="stylesheet" href="/css/base.css">
    <link rel="stylesheet" href="/css/layout.css">
    <link rel="stylesheet" href="/css/buttons.css">
    <link rel="stylesheet" href="/css/modal.css">
    <link rel="stylesheet" href="/css/text-block.css">
    <link rel="stylesheet" href="/css/links.css">
    <link rel="stylesheet" href="/css/pages.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;700&display=swap" rel="stylesheet">
    <link rel="manifest" href="/manifest.json">
    <link rel="apple-touch-icon" href="/img/apple_touch_icon_192x192.png">

    <!-- P콏id치me jednoduch칠 styly pro tla캜칤tko zm캩ny souhlasu, m콢쬰te je d치t do CSS -->
    <style>
        .change-consent-button {
            background: none;
            border: none;
            color: #555; /* Nebo barva odkazu z va코eho designu */
            text-decoration: underline;
            cursor: pointer;
            font-size: 0.8em;
            padding: 5px;
            display: block; /* Aby bylo na samostatn칠m 콏치dku v pati캜ce */
            margin: 5px auto 0 auto; /* Mal칳 horn칤 okraj a centrov치n칤 (pokud je v divu) */
            text-align: center; /* Centrov치n칤 textu */
        }
        .change-consent-button:hover {
            color: #000; /* Nebo jin치 barva pro hover */
        }
    </style>

</head>
<body class="home-page">

    <div class="page-wrapper">
        <header class="app-header">
            <img src="img/augview.png" alt="Logo AR Aplikace" id="app-logo">
            <h1>Vyberte kategorii sc칠n</h1>
        </header>

        <main class="menu-content">
            <!-- Va코e st치vaj칤c칤 tla캜칤tka -->
            <a href="/muzea_galerie.html" class="menu-button icon-button">
                <img src="img/muzea.png" alt="" class="button-icon">
                <span class="button-text">MUZEA GALERIE</span>
            </a>
            <a href="/mista_stezky.html" class="menu-button icon-button">
                <img src="img/mista.png" alt="" class="button-icon">
                <span class="button-text">M칈STA STEZKY</span>
            </a>
               <a href="/knihy_publikace.html" class="menu-button icon-button">
                <img src="img/kniha.png" alt="" class="button-icon">
                <span class="button-text">KNIHY PUBLIKACE</span>
            </a>
                <a href="info.html" class="menu-button icon-button">
                <img src="img/otaznik.png" alt="" class="button-icon">
                <span class="button-text">O AUGVIEW</span>
            </a>
                <a href="inventory.html" class="menu-button icon-button">
                <span class="button-icon">游끥</span>
                <span class="button-text">TROFEJE</span>
            </a>
        </main>

        <button id="help-button" class="help-icon-button" title="N치pov캩da">?</button>

        <div class="license-link-container">
             <a href="licence.html" class="license-link">Licence t콏et칤ch stran</a>
        </div>
       <!-- Tla캜칤tko pro zm캩nu souhlasu -->
            <button id="change-consent-button" class="change-consent-button">Zm캩nit nastaven칤 soukrom칤</button>
            <!-- Konec tla캜칤tka -->
        <footer class="app-footer">
            <p>춸 2025 Vytvo콏il V치clav P캩n캜칤k</p>
          
        </footer>

    </div> <!-- Konec page-wrapper -->

   <div id="help-modal" class="modal-overlay">
    <div class="modal-content">
   

<h2>游 Menu Panel</h2>
<div class="help-items-container">
    <div class="help-item">
        <img src="/img/muzea_45x45.png" alt="Ikona Muzea a Galerie" class="help-icon">
        <p>Zde naleznete doprovodn칠 AR prohl칤dky v Muze칤ch a Galeri칤ch.</p>
    </div>
    <hr>
    <div class="help-item">
        <img src="/img/mista_45x45.png" alt="Ikona Turistick치 m칤sta" class="help-icon">
        <p>Zde naleznete doprovodn칠 AR na turistick칳ch stezk치ch a m칤stech.</p>
    </div>
    <hr>
    <div class="help-item">
        <img src="/img/kniha_45x45.png" alt="Ikona Knihy a bro쬿ry" class="help-icon">
        <p>Zde naleznete doprovodn칠 AR ke knih치m a bro쬿r치m.</p>
    </div>
    <hr>
    <div class="help-item">
        <img src="/img/otaznik_45x45.png" alt="Ikona O aplikaci" class="help-icon">
        <p>Zde naleznete podrobn캩j코칤 informace o aplikaci AugView.</p>
    </div>
    <hr>
     <div class="help-item">
        <img src="/img/trofeje.png" alt="Ikona trofeje" class="help-icon">
        <p>Zde naleznete seznam 칰sp캩ch콢, kter칠 p캩hem sv칠ho putov치n칤 z칤sk치te.</p>
    </div>
</div>


       

        <!-- Tla캜칤tko pro zav콏en칤 mod치ln칤ho okna -->
        <button id="close-help-button" class="menu-button modal-close-button">Zp캩t do menu</button>
    </div>
</div>
    <!-- ==================================== -->

    <!-- P콏ipojen칤 JavaScriptu na konec body -->
    <!-- V치코 st치vaj칤c칤 script.js pro n치pov캩du atd. -->
    <script src="script.js"></script>
    <!-- V치코 st치vaj칤c칤 browser_check.js -->
    <script src="browser_check.js"></script>

    <!-- JavaScript pro tla캜칤tko zm캩ny souhlasu -->
    <script>
        const changeConsentBtn = document.getElementById('change-consent-button');
        if (changeConsentBtn) {
            changeConsentBtn.addEventListener('click', function() {
                console.log('Change consent button clicked.');
                // Jednoduch치 metoda: sma쬰me souhlas a po코leme u쬴vatele zp캩t na info str치nku
                try {
                    localStorage.removeItem('ga_consent_status');
                    // Voliteln캩 m콢쬰me smazat i flag prvn칤 n치v코t캩vy, aby se info zobrazilo jist캩
                    // localStorage.removeItem('arAppVisitedInfo_v1');
                    console.log('Consent status removed from localStorage.');
                    alert('Va코e nastaven칤 soukrom칤 bylo resetov치no. Budete p콏esm캩rov치ni pro novou volbu.');
                    window.location.href = 'info.html'; // P콏esm캩rujeme pro novou volbu
                } catch (e) {
                    console.error('Nepoda콏ilo se smazat consent status z localStorage:', e);
                    alert('Nastala chyba p콏i resetov치n칤 va코eho nastaven칤. Zkuste pros칤m vymazat data str치nek v prohl칤쬰캜i.');
                }
            });
        }
    </script>

</body>
</html>

<!DOCTYPE html>
<html lang="cs">
<head>
    <!-- iOS specifickÃ© meta tagy -->
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="default">
<meta name="apple-mobile-web-app-title" content="AugView">
<link rel="apple-touch-icon" sizes="180x180" href="/img/apple-touch-icon.png">
<link rel="apple-touch-startup-image" href="/img/apple-splash-2048-2732.png">
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="icon" type="image/png" href="img/favicon.png" />
    <title>AR Aplikace</title>

    <!-- === SKRIPT PRO KONTROLU PRVNÃ NÃVÅ TÄšVY (MUSÃ BÃT HNED NA ZAÄŒÃTKU HEAD) === -->
    <script>
      // NahraÄte skript v <head> index.html tÃ­mto kÃ³dem:
(function() {
  const visitedInfoFlagKey = 'arAppVisitedInfo_v1';
  const consentStatusKey = 'ga_consent_status';

  // Funkce pro bezpeÄnÃ© ÄtenÃ­ localStorage s fallbackem
  function safeGetLocalStorage(key) {
    try {
      return localStorage.getItem(key);
    } catch (e) {
      console.warn(`localStorage ÄtenÃ­ selhalo pro klÃ­Ä ${key}:`, e);
      return null;
    }
  }

  // Funkce pro bezpeÄnÃ© nastavenÃ­ localStorage
  function safeSetLocalStorage(key, value) {
    try {
      localStorage.setItem(key, value);
      return true;
    } catch (e) {
      console.warn(`localStorage zÃ¡pis selhal pro klÃ­Ä ${key}:`, e);
      return false;
    }
  }

  // Detekce iOS standalone reÅ¾imu
  const isIOSStandalone = navigator.userAgent.match(/iPhone|iPad|iPod/) && 
                         window.navigator.standalone;

  try {
    const hasVisited = safeGetLocalStorage(visitedInfoFlagKey);
    const consentStatus = safeGetLocalStorage(consentStatusKey);

    // Pro iOS standalone: pouÅ¾ij sessionStorage jako fallback
    if (isIOSStandalone && (!hasVisited || !consentStatus)) {
      const sessionVisited = sessionStorage.getItem(visitedInfoFlagKey);
      const sessionConsent = sessionStorage.getItem(consentStatusKey);
      
      if (!sessionVisited || !sessionConsent) {
        console.log('iOS standalone: PrvnÃ­ nÃ¡vÅ¡tÄ›va detekovÃ¡na. PÅ™esmÄ›rovÃ¡vÃ¡m na info.html');
        sessionStorage.setItem(visitedInfoFlagKey, 'true');
        window.location.replace('info.html');
        return;
      }
    }

    // StandardnÃ­ logika pro ostatnÃ­ pÅ™Ã­pady
    if (hasVisited !== 'true' || !consentStatus) {
      console.log('PrvnÃ­ nÃ¡vÅ¡tÄ›va nebo chybÄ›jÃ­cÃ­ souhlas detekovÃ¡n. PÅ™esmÄ›rovÃ¡vÃ¡m na info.html');
      
      if (hasVisited !== 'true') {
        safeSetLocalStorage(visitedInfoFlagKey, 'true');
      }
      
      window.location.replace('info.html');
    } else {
      console.log('OpakovanÃ¡ nÃ¡vÅ¡tÄ›va a souhlas nalezen. NaÄÃ­tÃ¡m index.html normÃ¡lnÄ›.');
    }
  } catch (e) {
    console.error('Chyba pÅ™i kontrole prvnÃ­ nÃ¡vÅ¡tÄ›vy:', e);
    // V pÅ™Ã­padÄ› chyby jdi na info strÃ¡nku pro jistotu
    window.location.replace('info.html');
  }
})();
    </script>
    <!-- === KONEC SKRIPTU PRVNÃ NÃVÅ TÄšVY === -->


    <!-- Google Analytics Consent Mode - VÃ½chozÃ­ nastavenÃ­ (PÅ˜ED gtag.js) -->
    <script>
        // Define dataLayer and the gtag function.
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}

        // NastavÃ­ vÃ½chozÃ­ stav souhlasu na ZAMÃTNUTO pÅ™ed naÄtenÃ­m gtag.js
        console.log('Setting default consent state to denied (index.html).');
        gtag('consent', 'default', {
            'ad_storage': 'denied',
            'ad_user_data': 'denied',
            'ad_personalization': 'denied',
            'analytics_storage': 'denied' // KlÃ­ÄovÃ© pro Google Analytics
        });

        // PokusÃ­ se naÄÃ­st uloÅ¾enÃ½ souhlas z localStorage
        // Tento kÃ³d se spustÃ­, jen pokud skript vÃ½Å¡e NEpÅ™esmÄ›roval na info.html
        const savedConsent = localStorage.getItem('ga_consent_status');
        if (savedConsent) {
            try {
                const consentState = JSON.parse(savedConsent);
                console.log('Found saved consent state on index.html:', consentState);
                gtag('consent', 'update', consentState); // Aktualizuje stav podle uloÅ¾enÃ© volby
            } catch (e) {
                console.error('Error parsing saved consent on index.html:', e);
                localStorage.removeItem('ga_consent_status'); // OdstranÃ­ neplatnÃ¡ data
            }
        } else {
             // Toto by nemÄ›lo nastat, pokud kontrola prvnÃ­ nÃ¡vÅ¡tÄ›vy funguje sprÃ¡vnÄ›,
             // ale pro jistotu logujeme.
             console.log('No saved consent found on index.html, default denied remains.');
        }
    </script>

    <!-- Google tag (gtag.js) - NaÄtenÃ­ knihovny -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-NRST1685GR"></script>
    <script>
        // Inicializace gtag funkce a volÃ¡nÃ­ 'config'
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());

        // TATO Å˜ÃDKA JE ZDE NUTNÃ - inicializuje mÄ›Å™enÃ­ pro GA4
        // Bude respektovat stav souhlasu nastavenÃ½ vÃ½Å¡e.
        gtag('config', 'G-NRST1685GR');
        console.log('gtag.js loaded and config command executed on index.html for G-NRST1685GR');
    </script>

    <!-- VaÅ¡e stÃ¡vajÃ­cÃ­ CSS a dalÅ¡Ã­ head tagy -->
    <link rel="stylesheet" href="/css/base.css">
    <link rel="stylesheet" href="/css/layout.css">
    <link rel="stylesheet" href="/css/buttons.css">
    <link rel="stylesheet" href="/css/modal.css">
    <link rel="stylesheet" href="/css/text-block.css">
    <link rel="stylesheet" href="/css/links.css">
    <link rel="stylesheet" href="/css/pages.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;700&display=swap" rel="stylesheet">
    <link rel="manifest" href="/manifest.json">
    <link rel="apple-touch-icon" href="/img/apple_touch_icon_192x192.png">

    <!-- PÅ™idÃ¡me jednoduchÃ© styly pro tlaÄÃ­tko zmÄ›ny souhlasu, mÅ¯Å¾ete je dÃ¡t do CSS -->
    <style>
        .change-consent-button {
            background: none;
            border: none;
            color: #555; /* Nebo barva odkazu z vaÅ¡eho designu */
            text-decoration: underline;
            cursor: pointer;
            font-size: 0.8em;
            padding: 5px;
            display: block; /* Aby bylo na samostatnÃ©m Å™Ã¡dku v patiÄce */
            margin: 5px auto 0 auto; /* MalÃ½ hornÃ­ okraj a centrovÃ¡nÃ­ (pokud je v divu) */
            text-align: center; /* CentrovÃ¡nÃ­ textu */
        }
        .change-consent-button:hover {
            color: #000; /* Nebo jinÃ¡ barva pro hover */
        }
    </style>

</head>
<body class="home-page">

    <div class="page-wrapper">
        <header class="app-header">
            <img src="img/augview.png" alt="Logo AR Aplikace" id="app-logo">
            <h1>Vyberte kategorii scÃ©n</h1>
        </header>

        <main class="menu-content">
            <!-- VaÅ¡e stÃ¡vajÃ­cÃ­ tlaÄÃ­tka -->
            <a href="/muzea_galerie.html" class="menu-button icon-button">
                <span class="button-icon">ğŸ›</span>
                <span class="button-text">MUZEA GALERIE</span>
            </a>
            <a href="/mista_stezky.html" class="menu-button icon-button">
                <span class="button-icon">ğŸ§­</span>
                <span class="button-text">MÃSTA STEZKY</span>
            </a>
               <a href="/knihy_publikace.html" class="menu-button icon-button">
                <span class="button-icon">ğŸ“š</span>
                <span class="button-text">KNIHY PUBLIKACE</span>
            </a>
                <a href="info.html" class="menu-button icon-button">
                <span class="button-icon">â“</span>
                <span class="button-text">O AUGVIEW</span>
            </a>
                <a href="inventory.html" class="menu-button icon-button">
                <span class="button-icon">ğŸ†</span>
                <span class="button-text">TROFEJE</span>
            </a>
        </main>

        <button id="help-button" class="help-icon-button" title="NÃ¡povÄ›da">?</button>

        <div class="license-link-container">
             <a href="licence.html" class="license-link">Licence tÅ™etÃ­ch stran</a>
        </div>
       <!-- TlaÄÃ­tko pro zmÄ›nu souhlasu -->
            <button id="change-consent-button" class="change-consent-button">ZmÄ›nit nastavenÃ­ soukromÃ­</button>
            <!-- Konec tlaÄÃ­tka -->
        <footer class="app-footer">
            <p>Â© 2025 VytvoÅ™il VÃ¡clav PÄ›nÄÃ­k</p>
          
        </footer>

    </div> <!-- Konec page-wrapper -->

   <div id="help-modal" class="modal-overlay">
    <div class="modal-content">
   

<h2>ğŸ“² Menu Panel</h2>
<div class="help-items-container">
    <div class="help-item">
        <span class="button-icon">ğŸ›</span>
        <p>Zde naleznete doprovodnÃ© AR prohlÃ­dky v MuzeÃ­ch a GaleriÃ­ch.</p>
    </div>
    <hr>
    <div class="help-item">
        <span class="button-icon">ğŸ§­</span>
        <p>Zde naleznete doprovodnÃ© AR na turistickÃ½ch stezkÃ¡ch a mÃ­stech.</p>
    </div>
    <hr>
    <div class="help-item">
        <span class="button-icon">ğŸ“š</span>
        <p>Zde naleznete doprovodnÃ© AR ke knihÃ¡m a broÅ¾urÃ¡m.</p>
    </div>
    <hr>
    <div class="help-item">
        <span class="button-icon">â“</span>
        <p>Zde naleznete podrobnÄ›jÅ¡Ã­ informace o aplikaci AugView.</p>
    </div>
    <hr>
     <div class="help-item">
        <span class="button-icon">ğŸ†</span>
        <p>Zde naleznete seznam ÃºspÄ›chÅ¯, kterÃ© pÄ›hem svÃ©ho putovÃ¡nÃ­ zÃ­skÃ¡te.</p>
    </div>
</div>


       

        <!-- TlaÄÃ­tko pro zavÅ™enÃ­ modÃ¡lnÃ­ho okna -->
        <button id="close-help-button" class="menu-button modal-close-button">ZpÄ›t do menu</button>
    </div>
</div>
    <!-- ==================================== -->

    <!-- PÅ™ipojenÃ­ JavaScriptu na konec body -->
    <!-- VÃ¡Å¡ stÃ¡vajÃ­cÃ­ script.js pro nÃ¡povÄ›du atd. -->
    <script src="script.js"></script>
    <!-- VÃ¡Å¡ stÃ¡vajÃ­cÃ­ browser_check.js -->
    <script src="browser_check.js"></script>

    <!-- JavaScript pro tlaÄÃ­tko zmÄ›ny souhlasu -->
    <script>
        const changeConsentBtn = document.getElementById('change-consent-button');
        if (changeConsentBtn) {
            changeConsentBtn.addEventListener('click', function() {
                console.log('Change consent button clicked.');
                // JednoduchÃ¡ metoda: smaÅ¾eme souhlas a poÅ¡leme uÅ¾ivatele zpÄ›t na info strÃ¡nku
                try {
                    localStorage.removeItem('ga_consent_status');
                    // VolitelnÄ› mÅ¯Å¾eme smazat i flag prvnÃ­ nÃ¡vÅ¡tÄ›vy, aby se info zobrazilo jistÄ›
                    // localStorage.removeItem('arAppVisitedInfo_v1');
                    console.log('Consent status removed from localStorage.');
                    alert('VaÅ¡e nastavenÃ­ soukromÃ­ bylo resetovÃ¡no. Budete pÅ™esmÄ›rovÃ¡ni pro novou volbu.');
                    window.location.href = 'info.html'; // PÅ™esmÄ›rujeme pro novou volbu
                } catch (e) {
                    console.error('NepodaÅ™ilo se smazat consent status z localStorage:', e);
                    alert('Nastala chyba pÅ™i resetovÃ¡nÃ­ vaÅ¡eho nastavenÃ­. Zkuste prosÃ­m vymazat data strÃ¡nek v prohlÃ­Å¾eÄi.');
                }
            });
        }
    </script>

</body>
</html>

<!DOCTYPE html>
<html lang="cs">
<head>
    <!-- iOS specifick√© meta tagy -->
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="default">
<meta name="apple-mobile-web-app-title" content="AugView">
<link rel="apple-touch-icon" sizes="180x180" href="/img/apple-touch-icon.png">
<link rel="apple-touch-startup-image" href="/img/apple-splash-2048-2732.png">
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="icon" type="image/png" href="img/favicon.png" />
    <title>AR Aplikace</title>

    <!-- === SKRIPT PRO KONTROLU PRVN√ç N√ÅV≈†TƒöVY (MUS√ç B√ùT HNED NA ZAƒå√ÅTKU HEAD) === -->
    <script>
      // Nahraƒète skript v <head> index.html t√≠mto k√≥dem:
(function() {
  const visitedInfoFlagKey = 'arAppVisitedInfo_v1';
  const consentStatusKey = 'ga_consent_status';

  // Funkce pro bezpeƒçn√© ƒçten√≠ localStorage s fallbackem
  function safeGetLocalStorage(key) {
    try {
      return localStorage.getItem(key);
    } catch (e) {
      console.warn(`localStorage ƒçten√≠ selhalo pro kl√≠ƒç ${key}:`, e);
      return null;
    }
  }

  // Funkce pro bezpeƒçn√© nastaven√≠ localStorage
  function safeSetLocalStorage(key, value) {
    try {
      localStorage.setItem(key, value);
      return true;
    } catch (e) {
      console.warn(`localStorage z√°pis selhal pro kl√≠ƒç ${key}:`, e);
      return false;
    }
  }

  // Detekce iOS standalone re≈æimu
  const isIOSStandalone = navigator.userAgent.match(/iPhone|iPad|iPod/) && 
                         window.navigator.standalone;

  try {
    const hasVisited = safeGetLocalStorage(visitedInfoFlagKey);
    const consentStatus = safeGetLocalStorage(consentStatusKey);

    // Pro iOS standalone: pou≈æij sessionStorage jako fallback
    if (isIOSStandalone && (!hasVisited || !consentStatus)) {
      const sessionVisited = sessionStorage.getItem(visitedInfoFlagKey);
      const sessionConsent = sessionStorage.getItem(consentStatusKey);
      
      if (!sessionVisited || !sessionConsent) {
        console.log('iOS standalone: Prvn√≠ n√°v≈°tƒõva detekov√°na. P≈ôesmƒõrov√°v√°m na info.html');
        sessionStorage.setItem(visitedInfoFlagKey, 'true');
        window.location.replace('info.html');
        return;
      }
    }

    // Standardn√≠ logika pro ostatn√≠ p≈ô√≠pady
    if (hasVisited !== 'true' || !consentStatus) {
      console.log('Prvn√≠ n√°v≈°tƒõva nebo chybƒõj√≠c√≠ souhlas detekov√°n. P≈ôesmƒõrov√°v√°m na info.html');
      
      if (hasVisited !== 'true') {
        safeSetLocalStorage(visitedInfoFlagKey, 'true');
      }
      
      window.location.replace('info.html');
    } else {
      console.log('Opakovan√° n√°v≈°tƒõva a souhlas nalezen. Naƒç√≠t√°m index.html norm√°lnƒõ.');
    }
  } catch (e) {
    console.error('Chyba p≈ôi kontrole prvn√≠ n√°v≈°tƒõvy:', e);
    // V p≈ô√≠padƒõ chyby jdi na info str√°nku pro jistotu
    window.location.replace('info.html');
  }
})();
    </script>
    <!-- === KONEC SKRIPTU PRVN√ç N√ÅV≈†TƒöVY === -->


    <!-- Google Analytics Consent Mode - V√Ωchoz√≠ nastaven√≠ (P≈òED gtag.js) -->
    <script>
        // Define dataLayer and the gtag function.
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}

        // Nastav√≠ v√Ωchoz√≠ stav souhlasu na ZAM√çTNUTO p≈ôed naƒçten√≠m gtag.js
        console.log('Setting default consent state to denied (index.html).');
        gtag('consent', 'default', {
            'ad_storage': 'denied',
            'ad_user_data': 'denied',
            'ad_personalization': 'denied',
            'analytics_storage': 'denied' // Kl√≠ƒçov√© pro Google Analytics
        });

        // Pokus√≠ se naƒç√≠st ulo≈æen√Ω souhlas z localStorage
        // Tento k√≥d se spust√≠, jen pokud skript v√Ω≈°e NEp≈ôesmƒõroval na info.html
        const savedConsent = localStorage.getItem('ga_consent_status');
        if (savedConsent) {
            try {
                const consentState = JSON.parse(savedConsent);
                console.log('Found saved consent state on index.html:', consentState);
                gtag('consent', 'update', consentState); // Aktualizuje stav podle ulo≈æen√© volby
            } catch (e) {
                console.error('Error parsing saved consent on index.html:', e);
                localStorage.removeItem('ga_consent_status'); // Odstran√≠ neplatn√° data
            }
        } else {
             // Toto by nemƒõlo nastat, pokud kontrola prvn√≠ n√°v≈°tƒõvy funguje spr√°vnƒõ,
             // ale pro jistotu logujeme.
             console.log('No saved consent found on index.html, default denied remains.');
        }
    </script>

    <!-- Google tag (gtag.js) - Naƒçten√≠ knihovny -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-NRST1685GR"></script>
    <script>
        // Inicializace gtag funkce a vol√°n√≠ 'config'
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());

        // TATO ≈ò√ÅDKA JE ZDE NUTN√Å - inicializuje mƒõ≈ôen√≠ pro GA4
        // Bude respektovat stav souhlasu nastaven√Ω v√Ω≈°e.
        gtag('config', 'G-NRST1685GR');
        console.log('gtag.js loaded and config command executed on index.html for G-NRST1685GR');
    </script>

    <!-- Va≈°e st√°vaj√≠c√≠ CSS a dal≈°√≠ head tagy -->
    <link rel="stylesheet" href="/css/base.css">
    <link rel="stylesheet" href="/css/layout.css">
    <link rel="stylesheet" href="/css/buttons.css">
    <link rel="stylesheet" href="/css/modal.css">
    <link rel="stylesheet" href="/css/text-block.css">
    <link rel="stylesheet" href="/css/links.css">
    <link rel="stylesheet" href="/css/pages.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;700&display=swap" rel="stylesheet">
    <link rel="manifest" href="/manifest.json">
    <link rel="apple-touch-icon" href="/img/apple_touch_icon_192x192.png">

    <!-- P≈ôid√°me jednoduch√© styly pro tlaƒç√≠tko zmƒõny souhlasu, m≈Ø≈æete je d√°t do CSS -->
    <style>
        .change-consent-button {
            background: none;
            border: none;
            color: #555; /* Nebo barva odkazu z va≈°eho designu */
            text-decoration: underline;
            cursor: pointer;
            font-size: 0.8em;
            padding: 5px;
            display: block; /* Aby bylo na samostatn√©m ≈ô√°dku v patiƒçce */
            margin: 5px auto 0 auto; /* Mal√Ω horn√≠ okraj a centrov√°n√≠ (pokud je v divu) */
            text-align: center; /* Centrov√°n√≠ textu */
        }
        .change-consent-button:hover {
            color: #000; /* Nebo jin√° barva pro hover */
        }
    </style>

</head>
<body class="home-page">

    <div class="page-wrapper">
        <header class="app-header">
            <img src="img/augview.png" alt="Logo AR Aplikace" id="app-logo">
            <h1>Vyberte kategorii sc√©n</h1>
        </header>

        <main class="menu-content">
            <!-- Va≈°e st√°vaj√≠c√≠ tlaƒç√≠tka -->
            <a href="/muzea_galerie.html" class="menu-button icon-button">
                <span class="button-icon">üèõ</span>
                <span class="button-text">MUZEA GALERIE</span>
            </a>
            <a href="/mista_stezky.html" class="menu-button icon-button">
                <span class="button-icon">üß≠</span>
                <span class="button-text">M√çSTA STEZKY</span>
            </a>
               <a href="/knihy_publikace.html" class="menu-button icon-button">
                <span class="button-icon">üìö</span>
                <span class="button-text">KNIHY PUBLIKACE</span>
            </a>
                <a href="info.html" class="menu-button icon-button">
                <span class="button-icon">‚ùì</span>
                <span class="button-text">O AUGVIEW</span>
            </a>
                <a href="inventory.html" class="menu-button icon-button">
                <span class="button-icon">üèÜ</span>
                <span class="button-text">TROFEJE</span>
            </a>
        </main>

        <button id="help-button" class="help-icon-button" title="N√°povƒõda">?</button>

        <div class="license-link-container">
             <a href="licence.html" class="license-link">Licence t≈ôet√≠ch stran</a>
        </div>
       <!-- Tlaƒç√≠tko pro zmƒõnu souhlasu -->
            <button id="change-consent-button" class="change-consent-button">Zmƒõnit nastaven√≠ soukrom√≠</button>
            <!-- Konec tlaƒç√≠tka -->
        <footer class="app-footer">
            <p>¬© 2025 Vytvo≈ôil V√°clav Pƒõnƒç√≠k</p>
          
        </footer>

    </div> <!-- Konec page-wrapper -->

   <div id="help-modal" class="modal-overlay">
    <div class="modal-content">
   

<h2>üì≤ Menu Panel</h2>
<div class="help-items-container">
    <div class="help-item">
        <img src="/img/muzea_45x45.png" alt="Ikona Muzea a Galerie" class="help-icon">
        <p>Zde naleznete doprovodn√© AR prohl√≠dky v Muze√≠ch a Galeri√≠ch.</p>
    </div>
    <hr>
    <div class="help-item">
        <img src="/img/mista_45x45.png" alt="Ikona Turistick√° m√≠sta" class="help-icon">
        <p>Zde naleznete doprovodn√© AR na turistick√Ωch stezk√°ch a m√≠stech.</p>
    </div>
    <hr>
    <div class="help-item">
        <img src="/img/kniha_45x45.png" alt="Ikona Knihy a bro≈æury" class="help-icon">
        <p>Zde naleznete doprovodn√© AR ke knih√°m a bro≈æur√°m.</p>
    </div>
    <hr>
    <div class="help-item">
        <img src="/img/otaznik_45x45.png" alt="Ikona O aplikaci" class="help-icon">
        <p>Zde naleznete podrobnƒõj≈°√≠ informace o aplikaci AugView.</p>
    </div>
    <hr>
     <div class="help-item">
        <img src="/img/trofeje.png" alt="Ikona trofeje" class="help-icon">
        <p>Zde naleznete seznam √∫spƒõch≈Ø, kter√© pƒõhem sv√©ho putov√°n√≠ z√≠sk√°te.</p>
    </div>
</div>


       

        <!-- Tlaƒç√≠tko pro zav≈ôen√≠ mod√°ln√≠ho okna -->
        <button id="close-help-button" class="menu-button modal-close-button">Zpƒõt do menu</button>
    </div>
</div>
    <!-- ==================================== -->

    <!-- P≈ôipojen√≠ JavaScriptu na konec body -->
    <!-- V√°≈° st√°vaj√≠c√≠ script.js pro n√°povƒõdu atd. -->
    <script src="script.js"></script>
    <!-- V√°≈° st√°vaj√≠c√≠ browser_check.js -->
    <script src="browser_check.js"></script>

    <!-- JavaScript pro tlaƒç√≠tko zmƒõny souhlasu -->
    <script>
        const changeConsentBtn = document.getElementById('change-consent-button');
        if (changeConsentBtn) {
            changeConsentBtn.addEventListener('click', function() {
                console.log('Change consent button clicked.');
                // Jednoduch√° metoda: sma≈æeme souhlas a po≈°leme u≈æivatele zpƒõt na info str√°nku
                try {
                    localStorage.removeItem('ga_consent_status');
                    // Volitelnƒõ m≈Ø≈æeme smazat i flag prvn√≠ n√°v≈°tƒõvy, aby se info zobrazilo jistƒõ
                    // localStorage.removeItem('arAppVisitedInfo_v1');
                    console.log('Consent status removed from localStorage.');
                    alert('Va≈°e nastaven√≠ soukrom√≠ bylo resetov√°no. Budete p≈ôesmƒõrov√°ni pro novou volbu.');
                    window.location.href = 'info.html'; // P≈ôesmƒõrujeme pro novou volbu
                } catch (e) {
                    console.error('Nepoda≈ôilo se smazat consent status z localStorage:', e);
                    alert('Nastala chyba p≈ôi resetov√°n√≠ va≈°eho nastaven√≠. Zkuste pros√≠m vymazat data str√°nek v prohl√≠≈æeƒçi.');
                }
            });
        }
    </script>

</body>
</html>

<!DOCTYPE html>
<html lang="cs">
<head> <!-- Všechny meta, link a script tagy patří SEM -->
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="icon" type="image/png" href="img/favicon.png" />
    <title>Vítejte - AR Aplikace</title> <!-- Mírně upravený titulek -->

    <!-- Google Analytics Consent Mode - Výchozí nastavení (MUSÍ BÝT PŘED gtag.js) -->
    <script>
        // Define dataLayer and the gtag function.
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}

        // Nastaví výchozí stav souhlasu na ZAMÍTNUTO před načtením gtag.js
        console.log('Setting default consent state to denied.'); // Log pro kontrolu
        gtag('consent', 'default', {
            'ad_storage': 'denied',
            'ad_user_data': 'denied',
            'ad_personalization': 'denied',
            'analytics_storage': 'denied' // Klíčové pro Google Analytics
        });

        // Pokusí se načíst uložený souhlas z localStorage (pro případ, že se uživatel vrátí)
        const savedConsent = localStorage.getItem('ga_consent_status');
        if (savedConsent) {
            try {
                const consentState = JSON.parse(savedConsent);
                 console.log('Found saved consent state:', consentState); // Log pro kontrolu
                gtag('consent', 'update', consentState); // Aktualizuje stav, pokud byl již udělen/zamítnut
            } catch (e) {
                console.error('Error parsing saved consent:', e);
                localStorage.removeItem('ga_consent_status'); // Odstraní neplatná data
            }
        } else {
             console.log('No saved consent found.'); // Log pro kontrolu
        }
    </script>

    <!-- Google tag (gtag.js) - Načtení knihovny -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-NRST1685GR"></script>
    <script>
        // Tento blok pouze inicializuje funkci gtag, pokud ještě neexistuje, a registruje čas načtení JS.
        // NENÍ ZDE gtag('config', ...) - to je klíčové pro info.html!
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());
        console.log('gtag.js loaded, config command SKIPPED on info.html'); // Log pro kontrolu
    </script>

    <!-- Vaše stávající CSS linky -->
    <link rel="stylesheet" href="/css/base.css">
    <link rel="stylesheet" href="/css/layout.css">
    <link rel="stylesheet" href="/css/buttons.css">
    <link rel="stylesheet" href="/css/modal.css">
    <link rel="stylesheet" href="/css/text-block.css">
    <link rel="stylesheet" href="/css/links.css">
    <link rel="stylesheet" href="/css/pages.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;700&display=swap" rel="stylesheet">
    <link rel="manifest" href="/manifest.json">
    <link rel="apple-touch-icon" href="/img/apple_touch_icon_192x192.png">

   
</head>
<body>

    <div class="page-wrapper"> <!-- Obalovač pro flexbox layout s patičkou dole -->

        <header class="app-header">
            <img src="img/augview.png" alt="Logo AR Aplikace" id="app-logo">
        </header>

       <main class="menu-content">
            <!-- Váš stávající obsah main -->
            <div class="text-content-block">
                <h2>Vítejte v aplikaci AugView!</h2>
                <p>
                   Tato aplikace vám přináší unikátní zážitky pomocí rozšířené reality (AR).
               </p>
               <p>
                   Určitě jste si někdy představili, jaké by to bylo, kdyby na vás v muzeu promluvila postava z obrazu.
                   Co kdyby se ilustrace v knize začala hýbat, nebo se z informační cedule vynořil trojrozměrný model?
                   Prohlédněte si naše interaktivní scény a objevte svět kolem sebe novým způsobem.
                </p>
                <p>
                    <ul>
                    <li>Kdykoli budete potřebovat poradit klikněte na ikonu otazníku vpravo dole. </li>
                   </ul>
                </p>
                <h2>Nyní klikněte na ikonu otazníku na této stránce.</h2>
                <p>
                    Pokud máte jakékoli dotazy nebo si přejete navázat spolupráci, neváhejte nás kontaktovat. Můžete nám
                    <a href="mailto:v.pencik@email.cz" class="email-link">napsat e-mail</a>.
                    Rádi vám pomůžeme!
               </p>
            </div>
            <!-- Konec textového bloku -->

            <a href="index.html" class="menu-button back-button">Zpět na hlavní menu</a>

        </main>

        <button id="help-button" class="help-icon-button" title="Nápověda">?</button>

        <footer class="app-footer">
            <p>© 2025 Vytvořil Václav Pěnčík</p>
        </footer>

    </div> <!-- Konec page-wrapper -->

    <!-- Modální okno nápovědy (Váš stávající kód) -->
    <div id="help-modal" class="modal-overlay">
        <!-- Obsah vašeho modálního okna nápovědy ... -->
        <div class="modal-content">
            <h2>Nápověda a první kroky</h2>
            <p>Pro nejlepší zážitek si přidejte aplikaci na plochu:</p>
             <div class="add-to-home-section">
                <h3>Android (Chrome)</h3>
                <p>Klepněte na ikonu tří teček (⋮) vpravo nahoře v prohlížeči Chrome, poté zvolte "Přidat na plochu" nebo "Instalovat aplikaci".</p>
            </div>
             <div class="add-to-home-section">
                <h3>iOS (Safari)</h3>
                <ol>
                    <li>Klepněte na ikonu Sdílet <img src="/img/ios_share_icon.png" alt="Ikona Sdílet na iOS" class="inline-icon ios-icon">.</li>
                    <li>Sjeďte dolů a vyberte "Přidat na plochu" <img src="/img/ios_add_icon.png" alt="Ikona Přidat na plochu na iOS" class="inline-icon ios-icon">.</li>
                </ol>
            </div>
             <section class="help-section">
                <h3>Důležité tipy</h3>
                 <ul>
                    <li>Pokud jste si přidali aplikaci na plochu, doporučujeme toto okno zavřít a pokračovat spuštěním přidané aplikace z plochy.</li>
                    <li>Pro správnou funkci aplikace je nutné aktivní internetové připojení.</li>
                 </ul>
            </section>
             <section class="help-section">
                <h3>Ukázka použití</h3>
                <p>Podívejte se na krátké video, jak aplikace funguje:</p>
                <div class="modal-video-container">
                    <video controls preload="metadata" playsinline poster="/img/video_poster_nahled.jpg">
                        <source src="video/nahled_ar.mp4" type="video/mp4">
                        Váš prohlížeč nepodporuje přehrávání HTML5 videa. Video si můžete <a href="video/nahled_ar.mp4" download>stáhnout zde</a>.
                    </video>
                </div>
                 <p>Pokračovat můžete z hlavního menu výběrem kategorie scén.</p>
            </section>
            <h2>Technologie</h2>
            <p>Aplikace využívá technologie MindAR a A-Frame.</p>
            <button id="close-help-button" class="menu-button modal-close-button">Zpět do menu</button>
        </div>
        <!-- Konec obsahu modálního okna nápovědy -->
    </div>

    <!-- === Consent Banner HTML === -->
    <div id="consent-banner">
      <p>Pro analýzu návštěvnosti a vylepšování aplikace používáme Google Analytics. Pomozte nám sběrem anonymních dat. Vaše soukromí je pro nás důležité. <a href="/privacy-policy.html" target="_blank">Více informací</a></p>
      <button id="consent-accept">Souhlasím</button> <!-- Můžete použít vaši CSS třídu -->
      <button id="consent-deny">Odmítám</button>   <!-- Můžete použít vaši CSS třídu -->
    </div>
    <!-- ========================== -->


    <!-- Připojení JavaScriptu na konec body -->
    <!-- Váš stávající script.js pro nápovědu atd. -->
    <script src="script.js"></script>

    <!-- JavaScript pro Consent Banner - UPRAVENO -->
    <script>
    document.addEventListener('DOMContentLoaded', function() {
      const banner = document.getElementById('consent-banner');
      const acceptButton = document.getElementById('consent-accept');
      const denyButton = document.getElementById('consent-deny');

      // Zkontrolujeme, zda uživatel již dříve volbu provedl
      const currentConsent = localStorage.getItem('ga_consent_status');

      if (!currentConsent) {
          // Pokud souhlas není uložen, zobrazíme banner
          console.log('Consent banner displayed.');
          banner.style.display = 'block';
      } else {
          // Pokud souhlas již existuje, banner NEZOBRAZÍME, ale zůstaneme na stránce info.html
          console.log('Consent already recorded. Banner remains hidden. User stays on info.html.');
          // ŘÁDEK PRO PŘESMĚROVÁNÍ JE ODSTRANĚN/ZAKOMENTOVÁN:
          // window.location.href = 'index.html';
          // return; // return také není potřeba, pokud nepřesměrováváme
      }

      // Funkce pro zpracování souhlasu (zůstává stejná jako v předchozí úpravě - bez přesměrování)
      function handleConsent(consentGranted) {
        const consentState = {
          'analytics_storage': consentGranted ? 'granted' : 'denied',
          'ad_storage': consentGranted ? 'granted' : 'denied',
          'ad_user_data': consentGranted ? 'granted' : 'denied',
          'ad_personalization': consentGranted ? 'granted' : 'denied',
        };

        if (typeof gtag === 'function') {
           gtag('consent', 'update', consentState);
           console.log('Consent updated via info.html:', consentState);
        } else {
           console.error('gtag function not defined when trying to update consent from info.html!');
        }

        localStorage.setItem('ga_consent_status', JSON.stringify(consentState));
        console.log('Consent saved to localStorage.');

        banner.style.display = 'none';
        console.log('Consent banner hidden. User stays on info.html.');
        // Přesměrování zde také není:
        // window.location.href = 'index.html';
      }

      // Event Listeners pro tlačítka (zůstávají stejné)
      acceptButton.addEventListener('click', function() {
        handleConsent(true);
      });

      denyButton.addEventListener('click', function() {
        handleConsent(false);
      });
    });
    </script>

</body>
</html>
